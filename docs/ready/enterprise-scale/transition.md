---
title: 既存の Azure 環境からエンタープライズ規模への移行
description: 既存の環境をエンタープライズ規模のアーキテクチャにオンボードする
author: BrianBlanchard
ms.author: brblanch
ms.date: 10/15/2020
ms.topic: conceptual
ms.service: cloud-adoption-framework
ms.subservice: ready
ms.custom: think-tank, csu
ms.openlocfilehash: 1fc58ed9f74d37eb641fce1d3571add71c3b5526
ms.sourcegitcommit: 32a958d1dd2d688cb112e9d1be1706bd1e59c505
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/12/2021
ms.locfileid: "98123478"
---
<!-- docutune:casing resourceType resourceTypes resourceId resourceIds -->

# <a name="transition-existing-azure-environments-to-enterprise-scale"></a>既存の Azure 環境をエンタープライズ規模に移行する

ほとんどの組織では、Azure 内の既存の占有領域、1 つ以上のサブスクリプション、そして場合によっては管理グループの既存の構造を保持している場合があると認識しています。 初期のビジネス要件とシナリオに応じて、ハイブリッド接続 (たとえば、サイト間 VPN や ExpressRoute) などの Azure リソースがデプロイされている場合があります。

この記事は、組織が、既存の Azure 環境に基づいてエンタープライズ規模への移行を適切に進めることができるように支援します。 また、この記事では、Azure でのリソースの移動 (既存のある管理グループから別の管理グループへのサブスクリプションの移動など) に関する考慮事項についても説明します。これは、既存の Azure 環境をエンタープライズ規模のランディング ゾーンに移行するための評価と計画に役立ちます。

## <a name="moving-resources-in-azure"></a>Azure でのリソースの移動

Azure の一部のリソースは作成後に移動できます。スコープでの、およびスコープをまたがるユーザーの Azure RBAC アクセス許可に従って、組織が取ることができるさまざまな手法があります。 次の表に、移動できるリソース、対象スコープ、それぞれに関連する長所と短所を示します。

| Scope | 到着地 | 長所 | 短所 |
|--|--|--|--|
| リソース グループ内のリソース | 同一または異なるサブスクリプションの新しいリソース グループに移動できる  | デプロイ後にリソース グループ内のリソース構成を変更できる | - すべての resourceType でサポートされているわけではない <br> - 一部の resourceType には特定の制限または要件がある <br> - resourceId が更新されるため、既存の監視、アラート、コントロール プレーンの操作に影響を及ぼす <br> - 移動期間中、リソース グループがロックされる <br> - 移動操作の前後にポリシーと RBAC を評価する必要がある |
| テナント内のサブスクリプション  | 異なる管理グループに移動できる | resourceId 値は変更されないため、サブスクリプション内の既存のリソースへの影響はない | 移動操作の前後にポリシーと RBAC を評価する必要がある |

どちらの移動方法を使用すべきかを理解するために、両方の例を紹介します。

## <a name="subscription-move"></a>サブスクリプションの移動

サブスクリプションを移動する一般的なユース ケースは、サブスクリプションを管理グループに整理することと、サブスクリプションを新しい Azure Active Directory テナントに移転することです。 エンタープライズ規模でのサブスクリプションの移動では、サブスクリプションを管理グループに移動することに重点が置かれます。 サブスクリプションを新しいテナントに移動するのは、主に[課金所有権を移転する](/azure/cost-management-billing/manage/billing-subscription-transfer)ためです。

### <a name="azure-rbac-requirements"></a>Azure RBAC の要件

移動の前にサブスクリプションを評価するうえで重要なのは、サブスクリプションの所有者である (ロールの直接割り当て) など、ユーザーに適切な Azure RBAC が割り当てられており、ターゲット管理グループに対する書き込みアクセス許可があることです (これをサポートする組み込みロールは、所有者ロール、共同作成者ロール、管理グループ共同作成者ロールです)。

ユーザーがサブスクリプションに対して既存の管理グループから継承された所有者ロールのアクセス許可を持っている場合、ユーザーに所有者ロールが割り当てられている管理グループにのみサブスクリプションを移動できます。

### <a name="policy"></a>ポリシー

既存のサブスクリプションは、直接的に、または現在配置されている管理グループで割り当てられた Azure ポリシーの対象となる場合があります。 現在のポリシーと、新しい管理グループまたは管理グループの階層に存在する可能性があるポリシーを評価することが重要です。

Azure Resource Graph を使用すると、既存のリソースのインベントリを実行し、その構成を、移動先に存在するポリシーと比較できます。

既存の Azure RBAC とポリシーが設定された管理グループにサブスクリプションを移動したら、次のオプションを検討します。

- 移動したサブスクリプションに継承された Azure RBAC は、管理グループ キャッシュ内のユーザー トークンが更新されるまで最大で 30 分かかります。 このプロセスを迅速に処理するには、サインアウトしてからサインインしてトークンを更新するか、新しいトークンを要求します。
- 移動したサブスクリプションが割り当てスコープに含まれているポリシーは、既存のリソースに対してのみ監査操作を実行します。 具体的には次のとおりです。
  - **deployIfNotExists** ポリシー結果の対象となる、サブスクリプション内の既存のリソースは非準拠として表示され、自動的には修復されません。手動で修復を実行するには、ユーザーによる操作が必要です。
  - **deny** ポリシー結果の対象となる、サブスクリプション内の既存のリソースは非準拠として表示され、拒否されません。 ユーザーは、この結果を必要に応じて手動で軽減する必要があります。
  - **append** および **modify** ポリシー結果の対象となる、サブスクリプション内の既存のリソースは非準拠として表示され、軽減するにはユーザーによる操作が必要です。
  - **audit** および **auditIfNotExist** の対象となる、サブスクリプション内の既存のリソースは非準拠として表示され、軽減するにはユーザーによる操作が必要です。
- 移動したサブスクリプション内のリソースへの新しい書き込みはすべて、通常どおりリアルタイムで割り当て済みポリシーの対象となります。

## <a name="resource-move"></a>リソースの移動

リソースの移動を行う主なユース ケースは、リソースが同じライフサイクルを共有する場合に同じリソース グループにまとめたり、コスト、所有権、または Azure RBAC の要件により、リソースを別のサブスクリプションに移動したりする必要がある場合です。

リソースの移動を行うと、移動操作中にソース リソース グループとターゲット リソース グループの両方がロックされます (このロックはリソース グループ内のどのリソースにも影響しません)。つまり、それらのリソース グループ内でリソースを追加、更新、削除できません。 リソースの移動操作では、リソースの場所を変更することはできません。

### <a name="before-you-move-resources"></a>リソースを移動する前に

移動操作の前に、[スコープ内のリソースがサポートされている](/azure/azure-resource-manager/management/move-support-resources)ことを確認し、それらの要件と依存関係を評価する必要があります。 たとえば、ピアリングされた仮想ネットワークを移動するには、最初に仮想ネットワーク ピアリングを無効にし、移動操作が完了したらピアリングを再度有効にする必要があります。 このように依存関係を無効にして再度有効にするには、事前に計画して、仮想ネットワークに接続されている可能性のある既存のワークロードへの影響を理解する必要があります。

### <a name="post-move-operation"></a>移動操作の後

リソースが同じサブスクリプション内の新しいリソース グループに移動された場合、管理グループまたはサブスクリプション、あるいはその両方のスコープから継承された Azure RBAC およびポリシーは引き続き適用されます。 新しいサブスクリプション内のリソース グループに移動する場合 (サブスクリプションが他の Azure RBAC およびポリシー割り当ての対象となる場合があります)、リソースのコンプライアンスとアクセスの制御を検証するために、サブスクリプションの移動シナリオと同じガイダンスが適用されます。
